<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=775" />
<title>Vars - Concourse CI</title>
<link rel="stylesheet" type="text/css" href="css/normalize.css" />
<link rel="stylesheet" type="text/css" href="css/pipeline.css" />
<link rel="stylesheet" type="text/css" href="css/iosevka.css" />
<link rel="stylesheet" type="text/css" href="css/booklit.css" />
<link rel="stylesheet" type="text/css" href="css/prism.css" />
<link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />
<link href="https://fonts.googleapis.com/css?family=Barlow:400,400i,700|Roboto+Slab:300,400,700" rel="stylesheet" />
<script src="js/search.js"></script>
<script async type="text/javascript" src="js/prism.js"></script>
<script data-goatcounter="https://concourse.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
  </head>
  <body>
    <div class="page-top">
      <nav class="top-nav">
  <a class="top-link logo-link" href="/"><img src="images/logo-white.svg" />Concourse</a>
  
  <a class="top-link active" href="docs.html">Docs</a>
  
  <a class="top-link" href="examples.html">Examples</a>
  
  <a class="top-link" href="project.html">Project</a>
  
  <a class="top-link" href="https://resource-types.concourse-ci.org">Resource Types</a>
  <a class="top-link" href="https://blog.concourse-ci.org">blog</a>
  <a class="top-link" href="https://github.com/concourse/concourse/discussions">discuss</a>

  <div id="search"></div>

  <script type="text/javascript">
    var app = Elm.Main.init({
      node: document.getElementById('search')
    });

    app.ports.emitSearchTerm.subscribe(function(term) {
      goatcounter.count({
        path: "search:" + term,
        title: "user searched: " + term,
        event: true
      });
    });
  </script>
</nav>
    </div>

    <div class="page-body">
      <div class="page-nav">
        






  
  
  

  
  <div class="context">
    <nav>
      <div class="top">
        <span class="section-number">1</span><a href="docs.html"  class="active">Docs</a>
      </div>

      <div class="children">
        <table>
        
          <tr>
            <td class="number-cell">1.1</td>
            <td class="title-cell"><a href="install.html" >Install</a></td>
          </tr>
        
          <tr>
            <td class="number-cell">1.2</td>
            <td class="title-cell"><a href="auth.html" >Auth &amp; Teams</a></td>
          </tr>
        
          <tr>
            <td class="number-cell">1.3</td>
            <td class="title-cell"><a href="fly.html" >The <code>fly</code> CLI</a></td>
          </tr>
        
          <tr>
            <td class="number-cell">1.4</td>
            <td class="title-cell"><a href="config-basics.html" >Config Basics</a></td>
          </tr>
        
          <tr>
            <td class="number-cell">1.5</td>
            <td class="title-cell"><a href="pipelines.html" >Pipelines</a></td>
          </tr>
        
          <tr>
            <td class="number-cell">1.6</td>
            <td class="title-cell"><a href="vars.html"  class="self">Vars</a></td>
          </tr>
        
          <tr>
            <td class="number-cell">1.7</td>
            <td class="title-cell"><a href="resources.html" >Resources</a></td>
          </tr>
        
          <tr>
            <td class="number-cell">1.8</td>
            <td class="title-cell"><a href="resource-types.html" >Resource Types</a></td>
          </tr>
        
          <tr>
            <td class="number-cell">1.9</td>
            <td class="title-cell"><a href="jobs.html" >Jobs</a></td>
          </tr>
        
          <tr>
            <td class="number-cell">1.10</td>
            <td class="title-cell"><a href="tasks.html" >Tasks</a></td>
          </tr>
        
          <tr>
            <td class="number-cell">1.11</td>
            <td class="title-cell"><a href="builds.html" >Builds</a></td>
          </tr>
        
          <tr>
            <td class="number-cell">1.12</td>
            <td class="title-cell"><a href="operation.html" >Operation</a></td>
          </tr>
        
          <tr>
            <td class="number-cell">1.13</td>
            <td class="title-cell"><a href="observation.html" >Observation</a></td>
          </tr>
        
          <tr>
            <td class="number-cell">1.14</td>
            <td class="title-cell"><a href="internals.html" >Internals</a></td>
          </tr>
        
        </table>
      </div>
    </nav>
  </div>
  

  

  
  <div class="context">
    <nav>
      <div class="top">
        <span class="section-number">1.6</span><a href="vars.html"  class="self">Vars</a>
      </div>

      <div class="children">
        <table>
        
          <tr>
            <td class="number-cell">1.6.1</td>
            <td class="title-cell"><a href="vars.html#var-syntax" ><code>((var))</code> syntax</a></td>
          </tr>
        
          <tr>
            <td class="number-cell">1.6.2</td>
            <td class="title-cell"><a href="vars.html#local-vars" >The &#34;<code>.</code>&#34; var source</a></td>
          </tr>
        
          <tr>
            <td class="number-cell">1.6.3</td>
            <td class="title-cell"><a href="vars.html#var-interpolation" >Interpolation</a></td>
          </tr>
        
          <tr>
            <td class="number-cell">1.6.4</td>
            <td class="title-cell"><a href="vars.html#static-vars" >Static vars</a></td>
          </tr>
        
          <tr>
            <td class="number-cell">1.6.5</td>
            <td class="title-cell"><a href="vars.html#dynamic-vars" >Dynamic vars</a></td>
          </tr>
        
        </table>
      </div>
    </nav>
  </div>
  



<div class="context">
  <div class="Top">
    On this page:
  </div>

  <div class="children anchors">
    <table>
      

      
  
    
      <tr>
        <td class="number-cell">1.6.1</td>
        <td class="title-cell"><a href="vars.html#var-syntax" ><code>((var))</code> syntax</a></td>
      </tr>
      
      
  
    
  

    
      <tr>
        <td class="number-cell">1.6.2</td>
        <td class="title-cell"><a href="vars.html#local-vars" >The &#34;<code>.</code>&#34; var source</a></td>
      </tr>
      
      
  
    
  

    
      <tr>
        <td class="number-cell">1.6.3</td>
        <td class="title-cell"><a href="vars.html#var-interpolation" >Interpolation</a></td>
      </tr>
      
      
  
    
  

    
      <tr>
        <td class="number-cell">1.6.4</td>
        <td class="title-cell"><a href="vars.html#static-vars" >Static vars</a></td>
      </tr>
      
      
  
    
  

    
      <tr>
        <td class="number-cell">1.6.5</td>
        <td class="title-cell"><a href="vars.html#dynamic-vars" >Dynamic vars</a></td>
      </tr>
      
      
  
    
      <tr>
        <td class="number-cell">1.6.5.1</td>
        <td class="title-cell"><a href="vars.html#var-sources" >Var sources <span class="dim">(experimental)</span></a></td>
      </tr>
      
        <tr>
          <td class="number-cell"><code>#</code></td>
          <td class="title-cell"><a href="vars.html#schema.var_source"><strong><code>var_source</code></strong> schema</a></td>
        </tr>
      
        <tr>
          <td class="number-cell"><code>#</code></td>
          <td class="title-cell"><a href="vars.html#schema.vault_config"><strong><code>vault_config</code></strong> schema</a></td>
        </tr>
      
        <tr>
          <td class="number-cell"><code>#</code></td>
          <td class="title-cell"><a href="vars.html#schema.dummy_config"><strong><code>dummy_config</code></strong> schema</a></td>
        </tr>
      
        <tr>
          <td class="number-cell"><code>#</code></td>
          <td class="title-cell"><a href="vars.html#schema.var_source.name"><code class="schema-attribute-name"><bold>var_source<wbr />.name</bold></code></a></td>
        </tr>
      
        <tr>
          <td class="number-cell"><code>#</code></td>
          <td class="title-cell"><a href="vars.html#schema.var_source.vault-var-source.type"><code>vault</code> var source <strong><code>type</code></strong></a></td>
        </tr>
      
        <tr>
          <td class="number-cell"><code>#</code></td>
          <td class="title-cell"><a href="vars.html#schema.vault_config.url"><code>vault</code> var source <strong><code>url</code></strong></a></td>
        </tr>
      
        <tr>
          <td class="number-cell"><code>#</code></td>
          <td class="title-cell"><a href="vars.html#schema.vault_config.ca_cert"><code>vault</code> var source <strong><code>ca_cert</code></strong></a></td>
        </tr>
      
        <tr>
          <td class="number-cell"><code>#</code></td>
          <td class="title-cell"><a href="vars.html#schema.vault_config.path_prefix"><code>vault</code> var source <strong><code>path_prefix</code></strong></a></td>
        </tr>
      
        <tr>
          <td class="number-cell"><code>#</code></td>
          <td class="title-cell"><a href="vars.html#schema.vault_config.lookup_templates"><code>vault</code> var source <strong><code>lookup_templates</code></strong></a></td>
        </tr>
      
        <tr>
          <td class="number-cell"><code>#</code></td>
          <td class="title-cell"><a href="vars.html#schema.vault_config.shared_path"><code>vault</code> var source <strong><code>shared_path</code></strong></a></td>
        </tr>
      
        <tr>
          <td class="number-cell"><code>#</code></td>
          <td class="title-cell"><a href="vars.html#schema.vault_config.namespace"><code>vault</code> var source <strong><code>namespace</code></strong></a></td>
        </tr>
      
        <tr>
          <td class="number-cell"><code>#</code></td>
          <td class="title-cell"><a href="vars.html#schema.vault_config.client_cert"><code>vault</code> var source <strong><code>client_cert</code></strong></a></td>
        </tr>
      
        <tr>
          <td class="number-cell"><code>#</code></td>
          <td class="title-cell"><a href="vars.html#schema.vault_config.client_key"><code>vault</code> var source <strong><code>client_key</code></strong></a></td>
        </tr>
      
        <tr>
          <td class="number-cell"><code>#</code></td>
          <td class="title-cell"><a href="vars.html#schema.vault_config.server_name"><code>vault</code> var source <strong><code>server_name</code></strong></a></td>
        </tr>
      
        <tr>
          <td class="number-cell"><code>#</code></td>
          <td class="title-cell"><a href="vars.html#schema.vault_config.insecure_skip_verify"><code>vault</code> var source <strong><code>insecure_skip_verify</code></strong></a></td>
        </tr>
      
        <tr>
          <td class="number-cell"><code>#</code></td>
          <td class="title-cell"><a href="vars.html#schema.vault_config.client_token"><code>vault</code> var source <strong><code>client_token</code></strong></a></td>
        </tr>
      
        <tr>
          <td class="number-cell"><code>#</code></td>
          <td class="title-cell"><a href="vars.html#schema.vault_config.auth_backend"><code>vault</code> var source <strong><code>auth_backend</code></strong></a></td>
        </tr>
      
        <tr>
          <td class="number-cell"><code>#</code></td>
          <td class="title-cell"><a href="vars.html#schema.vault_config.auth_params"><code>vault</code> var source <strong><code>auth_params</code></strong></a></td>
        </tr>
      
        <tr>
          <td class="number-cell"><code>#</code></td>
          <td class="title-cell"><a href="vars.html#schema.vault_config.auth_max_ttl"><code>vault</code> var source <strong><code>auth_max_ttl</code></strong></a></td>
        </tr>
      
        <tr>
          <td class="number-cell"><code>#</code></td>
          <td class="title-cell"><a href="vars.html#schema.vault_config.auth_retry_max"><code>vault</code> var source <strong><code>auth_retry_max</code></strong></a></td>
        </tr>
      
        <tr>
          <td class="number-cell"><code>#</code></td>
          <td class="title-cell"><a href="vars.html#schema.vault_config.auth_retry_initial"><code>vault</code> var source <strong><code>auth_retry_initial</code></strong></a></td>
        </tr>
      
        <tr>
          <td class="number-cell"><code>#</code></td>
          <td class="title-cell"><a href="vars.html#schema.var_source.vault-var-source.config"><code>vault</code> var source <strong><code>config</code></strong></a></td>
        </tr>
      
        <tr>
          <td class="number-cell"><code>#</code></td>
          <td class="title-cell"><a href="vars.html#vault-var-source"><code>vault</code> var source</a></td>
        </tr>
      
        <tr>
          <td class="number-cell"><code>#</code></td>
          <td class="title-cell"><a href="vars.html#schema.var_source.dummy-var-source.type"><code>dummy</code> var source <strong><code>type</code></strong></a></td>
        </tr>
      
        <tr>
          <td class="number-cell"><code>#</code></td>
          <td class="title-cell"><a href="vars.html#schema.dummy_config.vars"><code>dummy</code> var source <strong><code>vars</code></strong></a></td>
        </tr>
      
        <tr>
          <td class="number-cell"><code>#</code></td>
          <td class="title-cell"><a href="vars.html#schema.var_source.dummy-var-source.config"><code>dummy</code> var source <strong><code>config</code></strong></a></td>
        </tr>
      
        <tr>
          <td class="number-cell"><code>#</code></td>
          <td class="title-cell"><a href="vars.html#dummy-var-source"><code>dummy</code> var source</a></td>
        </tr>
      
      
  
    
  

    
      <tr>
        <td class="number-cell">1.6.5.2</td>
        <td class="title-cell"><a href="vars.html#cluster-wide-credential-manager" >The cluster-wide credential manager</a></td>
      </tr>
      
      
  
    
  

    
  

    
  

    </table>
  </div>
</div>

      </div>

      <div class="body-content">
        <div class="page-content">
          <div class="section" id="section_vars">
  
  <h1 class="section-header"><a class="anchor-target" name="vars" href="#vars"></a><span class="section-number">1.6 </span>Vars</h1>
  

  <p>Concourse supports value substitution in YAML configuration by way of <code>((vars))</code>.</p><p>Automation entails the use of all kinds of credentials. It&#39;s important to keep these values separate from the rest of your configuration by using vars instead of hardcoding values. This allows your configuration to be placed under source control and allows credentials to be tucked safely away into a secure credential manager like Vault instead of the Concourse database.</p><p>Aside from credentials, vars may also be used for generic parameterization of pipeline configuration templates, allowing a single pipeline config file to be configured multiple times with different parameters - e.g. <code>((branch_name))</code>.</p><div class="table-of-contents">
  <span class="toc-header">Table of contents:</span>

  
  
  <ol class="toc">
  
    <li>
      <span class="section-number">1.6.1</span>
      <a href="vars.html#var-syntax"><code>((var))</code> syntax</a>

      
  
  
    </li>
  
    <li>
      <span class="section-number">1.6.2</span>
      <a href="vars.html#local-vars">The &#34;<code>.</code>&#34; var source</a>

      
  
  
    </li>
  
    <li>
      <span class="section-number">1.6.3</span>
      <a href="vars.html#var-interpolation">Interpolation</a>

      
  
  
    </li>
  
    <li>
      <span class="section-number">1.6.4</span>
      <a href="vars.html#static-vars">Static vars</a>

      
  
  
    </li>
  
    <li>
      <span class="section-number">1.6.5</span>
      <a href="vars.html#dynamic-vars">Dynamic vars</a>

      
  
  <ol class="toc">
  
    <li>
      <span class="section-number">1.6.5.1</span>
      <a href="vars.html#var-sources">Var sources <span class="dim">(experimental)</span></a>

      
  
  
    </li>
  
    <li>
      <span class="section-number">1.6.5.2</span>
      <a href="vars.html#cluster-wide-credential-manager">The cluster-wide credential manager</a>

      
  
  
    </li>
  
  </ol>
  
  
    </li>
  
  </ol>
  
  
</div>

  
    
      <div class="section" id="section_var-syntax">
  
  <h2 class="section-header"><a class="anchor-target" name="var-syntax" href="#var-syntax"></a><code>((var))</code> syntax</h2>
  

  <p>The full syntax for vars is <code>((<em>source-name</em>:<em>secret-path</em>.<em>secret-field</em>))</code>.</p><p>The optional <em>source-name</em> identifies the <a href="vars.html#var-sources">var source</a> from which the value will be read. If omitted (along with the <code>:</code> delimiter), the <a href="vars.html#cluster-wide-credential-manager">cluster-wide credential manager</a> will be used, or the value may be provided <a href="vars.html#static-vars">statically</a>. The special name <code>.</code> refers to the <a href="vars.html#local-vars">local var source</a>, while any other name refers to a <a href="vars.html#var-sources">var source</a>.</p><p>The required <em>secret-path</em> identifies the location of the credential. The interpretation of this value depends on the var source type. For example, with Vault this may be a path like <code>path/to/cred</code>. For the Kubernetes secret manager this may just be the name of a secret. For credential managers which support path-based lookup, a <em>secret-path</em> without a leading / may be queried relative to a predefined set of path prefixes. This is how the Vault credential manager currently works; <code>foo</code> will be queried under <code>/concourse/(team name)/(pipeline name)/foo</code>.</p><p>The optional <em>secret-field</em> specifies a field on the fetched secret to read. If omitted, the credential manager may choose to read a &#39;default field&#39; from the fetched credential if the field exists. For example, the Vault credential manager will return the value of the <code>value</code> field if present. This is useful for simple single-value credentials where typing <code>((foo.value))</code> would feel verbose.</p><p>The <em>secret-path</em> and <em>secret-field</em> may be surrounded by double quotes <code>&#34;...&#34;</code> if they contain special characters like <code>.</code> and <code>:</code>. For instance, <code>((source:&#34;my.secret&#34;.&#34;field:1&#34;))</code> will set the <em>secret-path</em> to <code>my.secret</code> and the <em>secret-field</em> to <code>field:1</code>.</p>

  
    
  
</div>
    
      <div class="section" id="section_local-vars">
  
  <h2 class="section-header"><a class="anchor-target" name="local-vars" href="#local-vars"></a>The &#34;<code>.</code>&#34; var source</h2>
  

  <p>The special var source name <code>.</code> refers to a &#34;local var source.&#34;</p><p>The precise scope for these &#34;local vars&#34; depends on where they&#39;re being used. Currently the only mechanism that uses the local var source is the <a href="jobs.html#load-var-step"><code>load_var</code> step</a>, which sets a var in a local var source provided to all steps executed in the build.</p>

  
    
  
</div>
    
      <div class="section" id="section_var-interpolation">
  
  <h2 class="section-header"><a class="anchor-target" name="var-interpolation" href="#var-interpolation"></a>Interpolation</h2>
  

  <p>Values for vars are substituted structurally. That is, if you have <code>foo: ((bar))</code>, whatever value <code>((bar))</code> resolves to will become the value of the <code>foo</code> field in the object. This can be a value of any type and structure: a boolean, a simple string, a multiline credential like a certificate, or a complicated data structure like an array of objects.</p><p>This differs from text-based substitution in that it&#39;s impossible for a value to result in broken YAML syntax, and it relieves the template author from having to worry about things like whitespace alignment.</p><p>When a <code>((var))</code> appears adjacent to additional string content, e.g. <code>foo: hello-((bar))-goodbye</code>, its value will be concatenated with the surrounding content. If the <code>((var))</code> resolves to a non-string value, an error will be raised.</p>

  
    
  
</div>
    
      <div class="section" id="section_static-vars">
  
  <h2 class="section-header"><a class="anchor-target" name="static-vars" href="#static-vars"></a>Static vars</h2>
  

  <p>Var values may also be specified statically using the <a href="jobs.html#schema.step.set-pipeline-step.vars"><code>set_pipeline</code> step</a> and <a href="jobs.html#schema.step.task-step.vars"><code>task</code> step</a>.</p><p>When running the <a href="fly.html"><code>fly</code> CLI</a> equivalent commands (<a href="setting-pipelines.html#fly-set-pipeline"><code>fly set-pipeline</code></a> and <a href="tasks.html#running-tasks"><code>fly execute</code></a>), var values may be provided using the following flags:</p><ul>

  <li><p><code>-v</code> or <code>--var</code> <code>NAME=VALUE</code> sets the string <code>VALUE</code> as the value for the var <code>NAME</code>.</p></li>

  <li><p><code>-y</code> or <code>--yaml-var</code> <code>NAME=VALUE</code> parses <code>VALUE</code> as YAML and sets it as the value for the var <code>NAME</code>.</p></li>

  <li><p><code>-l</code> or <code>--load-vars-from</code> <code>FILE</code> loads <code>FILE</code>, a YAML document containing mapping var names to values, and sets them all.</p></li>

</ul><p>When used in combination with <code>-l</code>, the <code>-y</code> and <code>-v</code> flags take precedence. This way a vars file may be re-used, overriding individual values by hand.</p><div class="toggleable example">
  <input id="toggle-cfad2fce8bfcbbdc74051faee697c756f9881295" type="checkbox" class="toggle" />
  <label for="toggle-cfad2fce8bfcbbdc74051faee697c756f9881295" class="toggle-title">Setting values with the <code>task</code> step</label>
  <div class="toggle-content">
    <p>Let&#39;s say we have a <a href="tasks.html#schema.task">task config</a> like so:</p><pre><code class="language-yaml">platform: linux

image_resource:
  type: registry-image
  source:
    repository: golang
    tag: ((tag))

inputs:
- name: booklit

run:
  path: booklit/ci/unit</code></pre><p>We could use <a href="jobs.html#schema.step.task-step.vars"><code>vars</code></a> to run this task against different versions of Go:</p><pre><code class="language-yaml">jobs:
- name: unit
  plan:
  - get: booklit
    trigger: true
  - task: unit-1.13
    file: booklit/ci/unit.yml
    vars: {tag: 1.13}
  - task: unit-1.8
    file: booklit/ci/unit.yml
    vars: {tag: 1.8}</code></pre>
  </div>
</div><div class="toggleable example">
  <input id="toggle-513ec32492198937a84ef39861ffebf493af1ae2" type="checkbox" class="toggle" />
  <label for="toggle-513ec32492198937a84ef39861ffebf493af1ae2" class="toggle-title">Setting values with <code>-v</code> and <code>y</code></label>
  <div class="toggle-content">
    <p>With a pipeline template like so:</p><pre><code class="language-yaml">resources:
- name: booklit
  type: booklit
  source:
    uri: https://github.com/vito/booklit
    branch: ((branch))
    private_key: ((private_key))

jobs:
- name: unit
  plan:
  - get: booklit
    trigger: ((trigger))
  - task: unit
    file: booklit/ci/unit.yml</code></pre><p>Let&#39;s say we have a private key in a file called <code>private_key</code>.</p><p>The <a href="setting-pipelines.html#fly-validate-pipeline"><code>fly validate-pipeline</code></a> command may be used to test how interpolation is applied, by passing the <code>--output</code> flag.</p><pre><code class="language-sh">$ fly validate-pipeline \
  -c pipeline.yml \
  -y trigger=true \
  -v private_key=&#34;$(cat private_key)&#34; \
  -v branch=master \
  --output</code></pre><p>The above incantation should print the following:</p><pre><code class="language-yaml">jobs:
- name: unit
  plan:
  - get: booklit
    trigger: true
  - file: booklit/ci/unit.yml
    task: unit
resources:
- name: booklit
  type: booklit
  source:
    branch: master
    private_key: |
      -----BEGIN RSA PRIVATE KEY-----
      # ... snipped ...
      -----END RSA PRIVATE KEY-----
    uri: https://github.com/vito/booklit</code></pre><p>Note that we had to use <code>-y</code> so that the <code>trigger: true</code> ends up with a boolean value instead of the string <code>&#34;true&#34;</code>.</p>
  </div>
</div><div class="toggleable example">
  <input id="toggle-72d3147ae566c2d517584a4edf96ab7080320149" type="checkbox" class="toggle" />
  <label for="toggle-72d3147ae566c2d517584a4edf96ab7080320149" class="toggle-title">Loading values from files with <code>-l</code></label>
  <div class="toggle-content">
    <p>With a pipeline template like so:</p><pre><code class="language-yaml">resources:
- name: booklit
  type: booklit
  source:
    uri: https://github.com/vito/booklit
    branch: ((branch))
    private_key: ((private_key))

jobs:
- name: unit
  plan:
  - get: booklit
    trigger: ((trigger))
  - task: unit
    file: booklit/ci/unit.yml</code></pre><p>Let&#39;s say I&#39;ve put the <code>private_key</code> var in a file called <code>vars.yml</code>, since it&#39;s quite large and hard to pass through flags:</p><pre><code class="language-yaml">private_key: |
  -----BEGIN RSA PRIVATE KEY-----
  # ... snipped ...
  -----END RSA PRIVATE KEY-----</code></pre><p>The <a href="setting-pipelines.html#fly-validate-pipeline"><code>fly validate-pipeline</code></a> command may be used to test how interpolation is applied, by passing the <code>--output</code> flag.</p><pre><code class="language-sh">$ fly validate-pipeline \
  -c pipeline.yml \
  -l vars.yml \
  -y trigger=true \
  -v branch=master \
  --output</code></pre><p>The above incantation should print the following:</p><pre><code class="language-yaml">jobs:
- name: unit
  plan:
  - get: booklit
    trigger: true
  - task: unit
    file: booklit/ci/unit.yml
resources:
- name: booklit
  type: booklit
  source:
    branch: master
    private_key: |
      -----BEGIN RSA PRIVATE KEY-----
      # ... snipped ...
      -----END RSA PRIVATE KEY-----
    uri: https://github.com/vito/booklit</code></pre><p>Note that we had to use <code>-y</code> so that the <code>trigger: true</code> ends up with a boolean value instead of the string <code>&#34;true&#34;</code>.</p>
  </div>
</div>

  
    
  
</div>
    
      <div class="section" id="section_dynamic-vars">
  
  <h2 class="section-header"><a class="anchor-target" name="dynamic-vars" href="#dynamic-vars"></a>Dynamic vars</h2>
  

  <p>Concourse can read values from &#34;var sources&#34; - typically credential managers like Vault - at runtime. This keeps them out of your configuration and prevents sensitive values from being stored in your database. Values will be read from the var source and optionally <a href="creds-caching.html">cached</a> to reduce load on the var source.</p><p>The following attributes can be parameterized through a var source:</p><ul>

  <li><p><a href="resources.html#schema.resource.source"><code class="schema-attribute-name"><bold>resource<wbr />.source</bold></code></a> under <a href="pipelines.html#schema.pipeline.resources"><code class="schema-attribute-name"><bold>pipeline<wbr />.resources</bold></code></a></p></li>

  <li><p><a href="resource-types.html#schema.resource_type.source"><code class="schema-attribute-name"><bold>resource_type<wbr />.source</bold></code></a> under <a href="pipelines.html#schema.pipeline.resources"><code class="schema-attribute-name"><bold>pipeline<wbr />.resources</bold></code></a></p></li>

  <li><p><a href="resources.html#schema.resource.webhook_token"><code class="schema-attribute-name"><bold>resource<wbr />.webhook_token</bold></code></a> under <a href="pipelines.html#schema.pipeline.resources"><code class="schema-attribute-name"><bold>pipeline<wbr />.resources</bold></code></a></p></li>

  <li><p><a href="jobs.html#schema.step.task-step.params"><code>task</code> step <strong><code>params</code></strong></a> on a task step in a pipeline</p></li>

  <li><p><a href="tasks.html">Tasks</a> in their entirety - whether from <a href="jobs.html#schema.step.task-step.file"><code>task</code> step <strong><code>file</code></strong></a> or <a href="jobs.html#schema.step.task-step.config"><code>task</code> step <strong><code>config</code></strong></a> in a pipeline, or a config executed with <a href="tasks.html#running-tasks"><code>fly execute</code></a></p></li>

</ul><p>Concourse will fetch values for vars as late as possible - i.e. when a step using them is about to execute. This allows the credentials to have limited lifetime and rapid rotation policies.</p>

  
    
      <div class="section" id="section_var-sources">
  
  <h3 class="section-header"><a class="anchor-target" name="var-sources" href="#var-sources"></a>Var sources <span class="dim">(experimental)</span></h3>
  

  <div class="warning">
  <p><code>var_sources</code> was introduced in Concourse v5.8.0. It is considered an <strong>experimental</strong> feature until its associated <a href="https://github.com/concourse/rfcs/pull/39">RFC</a> is resolved.</p>
</div><p>Var sources can be configured for a pipeline via <a href="pipelines.html#schema.pipeline.var_sources"><code class="schema-attribute-name"><bold>pipeline<wbr />.var_sources</bold></code></a>.</p><p>Each var source has a name which is then referenced as the <em>source-name</em> in var syntax, e.g. <code>((my-vault:test-user.username))</code> to fetch the <code>test-user</code> var from the <code>my-vault</code> var source. See <a href="vars.html#var-syntax"><code>((var))</code> syntax</a> for a detailed explanation of this syntax.</p><p>Currently, only two types are supported: <code>vault</code> and <code>dummy</code>. In the future we want to make use of something like the <a href="https://github.com/concourse/rfcs/pull/37">Prototypes (RFC #37)</a> so that third-party credential managers can be used just like resource types.</p><div class="schema">
  <h2 class="schema-header"><a class="anchor-target" name="schema.var_source" href="#schema.var_source"></a><code>var_source</code> schema</h2>

  <div class="toggleable schema-attribute required">
  <input id="toggle-schema.var_source.name" type="checkbox" class="toggle" />
  <label for="toggle-schema.var_source.name" class="toggle-title">
    <a id="schema.var_source.name"></a>

    <code><a class="attribute-name" href="#schema.var_source.name">name</a>: <span class="attribute-type"><a href="config-basics.html#schema.string"><strong>string</strong></a></span></code>
  </label>

  <div class="toggle-content attribute-content">
    <p>The name of the <code>((var))</code> source. This should be short and simple. This name will be referenced <a href="vars.html#var-syntax"><code>((var))</code> syntax</a> throughout the config.</p>
  </div>
</div><div class="schema-one-of">
  <div class="one-of-header">one of...</div>

  
  <div class="one-of-option">
    <div class="schema-group">
  <a id="vault-var-source"></a>
  <div class="toggleable schema-attribute required">
  <input id="toggle-schema.var_source.vault-var-source.type" type="checkbox" class="toggle" />
  <label for="toggle-schema.var_source.vault-var-source.type" class="toggle-title">
    <a id="schema.var_source.vault-var-source.type"></a>

    <code><a class="attribute-name" href="#schema.var_source.vault-var-source.type">type</a>: <span class="attribute-type"><span class="schema-scalar">vault</span></span></code>
  </label>

  <div class="toggle-content attribute-content">
    <p>The <code>vault</code> type supports configuring a <a href="https://www.vaultproject.io">Vault</a> server as a <code>((var))</code> source.</p>
  </div>
</div><div class="toggleable schema-attribute required">
  <input id="toggle-schema.var_source.vault-var-source.config" type="checkbox" class="toggle" />
  <label for="toggle-schema.var_source.vault-var-source.config" class="toggle-title">
    <a id="schema.var_source.vault-var-source.config"></a>

    <code><a class="attribute-name" href="#schema.var_source.vault-var-source.config">config</a>: <span class="attribute-type"><a href="vars.html#schema.vault_config"><strong>vault_config</strong></a></span></code>
  </label>

  <div class="toggle-content attribute-content">
    <p>Configuration for the Vault server has the following schema:</p><div class="schema">
  <h2 class="schema-header"><a class="anchor-target" name="schema.vault_config" href="#schema.vault_config"></a><code>vault_config</code> schema</h2>

  <div class="toggleable schema-attribute required">
  <input id="toggle-schema.vault_config.url" type="checkbox" class="toggle" />
  <label for="toggle-schema.vault_config.url" class="toggle-title">
    <a id="schema.vault_config.url"></a>

    <code><a class="attribute-name" href="#schema.vault_config.url">url</a>: <span class="attribute-type"><a href="config-basics.html#schema.string"><strong>string</strong></a></span></code>
  </label>

  <div class="toggle-content attribute-content">
    <p>The URL of the Vault API.</p>
  </div>
</div><div class="toggleable schema-attribute optional">
  <input id="toggle-schema.vault_config.ca_cert" type="checkbox" class="toggle" />
  <label for="toggle-schema.vault_config.ca_cert" class="toggle-title">
    <a id="schema.vault_config.ca_cert"></a>

    <code><a class="attribute-name" href="#schema.vault_config.ca_cert">ca_cert</a>: <span class="attribute-type"><a href="config-basics.html#schema.string"><strong>string</strong></a></span></code>
  </label>

  <div class="toggle-content attribute-content">
    <p>The PEM encoded contents of a CA certificate to use when connecting to the API.</p>
  </div>
</div><div class="toggleable schema-attribute optional">
  <input id="toggle-schema.vault_config.path_prefix" type="checkbox" class="toggle" />
  <label for="toggle-schema.vault_config.path_prefix" class="toggle-title">
    <a id="schema.vault_config.path_prefix"></a>

    <code><a class="attribute-name" href="#schema.vault_config.path_prefix">path_prefix</a>: <span class="attribute-type"><a href="config-basics.html#schema.string"><strong>string</strong></a></span></code>
  </label>

  <div class="toggle-content attribute-content">
    <p><em>Default <code>/concourse</code>.</em> A prefix under which to look for all credential values.</p><p>See <a href="vault-credential-manager.html#vault-path-prefix">Changing the path prefix</a> for more information.</p>
  </div>
</div><div class="toggleable schema-attribute optional">
  <input id="toggle-schema.vault_config.lookup_templates" type="checkbox" class="toggle" />
  <label for="toggle-schema.vault_config.lookup_templates" class="toggle-title">
    <a id="schema.vault_config.lookup_templates"></a>

    <code><a class="attribute-name" href="#schema.vault_config.lookup_templates">lookup_templates</a>: <span class="attribute-type">[<a href="config-basics.html#schema.string"><strong>string</strong></a>]</span></code>
  </label>

  <div class="toggle-content attribute-content">
    <p><em>Default <code>[&#34;/{{.Team}}/{{.Pipeline}}/{{.Secret}}&#34;, &#34;/{{.Team}}/{{.Secret}}&#34;]</code>.</em></p><p>A list of path templates to be expanded in a team and pipeline context subject to the <code>path_prefix</code> and <code>namespace</code>.</p><p>See <a href="vault-credential-manager.html#vault-lookup-templates">Changing the path templates</a> for more information.</p>
  </div>
</div><div class="toggleable schema-attribute optional">
  <input id="toggle-schema.vault_config.shared_path" type="checkbox" class="toggle" />
  <label for="toggle-schema.vault_config.shared_path" class="toggle-title">
    <a id="schema.vault_config.shared_path"></a>

    <code><a class="attribute-name" href="#schema.vault_config.shared_path">shared_path</a>: <span class="attribute-type"><a href="config-basics.html#schema.string"><strong>string</strong></a></span></code>
  </label>

  <div class="toggle-content attribute-content">
    <p>An additional path under which credentials will be looked up.</p><p>See <a href="vault-credential-manager.html#vault-shared-path">Configuring a shared path</a> for more information.</p>
  </div>
</div><div class="toggleable schema-attribute optional">
  <input id="toggle-schema.vault_config.namespace" type="checkbox" class="toggle" />
  <label for="toggle-schema.vault_config.namespace" class="toggle-title">
    <a id="schema.vault_config.namespace"></a>

    <code><a class="attribute-name" href="#schema.vault_config.namespace">namespace</a>: <span class="attribute-type"><a href="config-basics.html#schema.string"><strong>string</strong></a></span></code>
  </label>

  <div class="toggle-content attribute-content">
    <p>A <a href="https://www.vaultproject.io/docs/enterprise/namespaces/index.html">Vault namespace</a> to operate under.</p>
  </div>
</div><div class="toggleable schema-attribute optional">
  <input id="toggle-schema.vault_config.client_cert" type="checkbox" class="toggle" />
  <label for="toggle-schema.vault_config.client_cert" class="toggle-title">
    <a id="schema.vault_config.client_cert"></a>

    <code><a class="attribute-name" href="#schema.vault_config.client_cert">client_cert</a>: <span class="attribute-type"><a href="config-basics.html#schema.string"><strong>string</strong></a></span></code>
  </label>

  <div class="toggle-content attribute-content">
    <p>A PEM encoded client certificate, for use with TLS based auth.</p><p>See <a href="vault-credential-manager.html#vault-cert-auth">Using the <code>cert</code> auth backend</a> for more information.</p>
  </div>
</div><div class="toggleable schema-attribute optional">
  <input id="toggle-schema.vault_config.client_key" type="checkbox" class="toggle" />
  <label for="toggle-schema.vault_config.client_key" class="toggle-title">
    <a id="schema.vault_config.client_key"></a>

    <code><a class="attribute-name" href="#schema.vault_config.client_key">client_key</a>: <span class="attribute-type"><a href="config-basics.html#schema.string"><strong>string</strong></a></span></code>
  </label>

  <div class="toggle-content attribute-content">
    <p>A PEM encoded client key, for use with TLS based auth.</p><p>See <a href="vault-credential-manager.html#vault-cert-auth">Using the <code>cert</code> auth backend</a> for more information.</p>
  </div>
</div><div class="toggleable schema-attribute optional">
  <input id="toggle-schema.vault_config.server_name" type="checkbox" class="toggle" />
  <label for="toggle-schema.vault_config.server_name" class="toggle-title">
    <a id="schema.vault_config.server_name"></a>

    <code><a class="attribute-name" href="#schema.vault_config.server_name">server_name</a>: <span class="attribute-type"><a href="config-basics.html#schema.string"><strong>string</strong></a></span></code>
  </label>

  <div class="toggle-content attribute-content">
    <p>The expected name of the server when connecting through TLS.</p>
  </div>
</div><div class="toggleable schema-attribute optional">
  <input id="toggle-schema.vault_config.insecure_skip_verify" type="checkbox" class="toggle" />
  <label for="toggle-schema.vault_config.insecure_skip_verify" class="toggle-title">
    <a id="schema.vault_config.insecure_skip_verify"></a>

    <code><a class="attribute-name" href="#schema.vault_config.insecure_skip_verify">insecure_skip_verify</a>: <span class="attribute-type"><a href="config-basics.html#schema.boolean"><strong>boolean</strong></a></span></code>
  </label>

  <div class="toggle-content attribute-content">
    <p>Skip TLS validation. Not recommended. Don&#39;t do it. No really, don&#39;t.</p>
  </div>
</div><div class="toggleable schema-attribute optional">
  <input id="toggle-schema.vault_config.client_token" type="checkbox" class="toggle" />
  <label for="toggle-schema.vault_config.client_token" class="toggle-title">
    <a id="schema.vault_config.client_token"></a>

    <code><a class="attribute-name" href="#schema.vault_config.client_token">client_token</a>: <span class="attribute-type"><a href="config-basics.html#schema.string"><strong>string</strong></a></span></code>
  </label>

  <div class="toggle-content attribute-content">
    <p>Authenticate via a periodic client token.</p><p>See <a href="vault-credential-manager.html#vault-periodic-token">Using a periodic token</a> for more information.</p>
  </div>
</div><div class="toggleable schema-attribute optional">
  <input id="toggle-schema.vault_config.auth_backend" type="checkbox" class="toggle" />
  <label for="toggle-schema.vault_config.auth_backend" class="toggle-title">
    <a id="schema.vault_config.auth_backend"></a>

    <code><a class="attribute-name" href="#schema.vault_config.auth_backend">auth_backend</a>: <span class="attribute-type"><a href="config-basics.html#schema.string"><strong>string</strong></a></span></code>
  </label>

  <div class="toggle-content attribute-content">
    <p>Authenticate using an auth backend, e.g. <code>cert</code> or <code>approle</code>.</p><p>See <a href="vault-credential-manager.html#vault-approle-auth">Using the <code>approle</code> auth backend</a> or <a href="vault-credential-manager.html#vault-cert-auth">Using the <code>cert</code> auth backend</a> for more information.</p>
  </div>
</div><div class="toggleable schema-attribute optional">
  <input id="toggle-schema.vault_config.auth_params" type="checkbox" class="toggle" />
  <label for="toggle-schema.vault_config.auth_params" class="toggle-title">
    <a id="schema.vault_config.auth_params"></a>

    <code><a class="attribute-name" href="#schema.vault_config.auth_params">auth_params</a>: <span class="attribute-type">{<a href="config-basics.html#schema.string"><strong>string</strong></a>: <a href="config-basics.html#schema.string"><strong>string</strong></a>}</span></code>
  </label>

  <div class="toggle-content attribute-content">
    <p>A key-value map of parameters to pass during authentication.</p><p>See <a href="vault-credential-manager.html#vault-approle-auth">Using the <code>approle</code> auth backend</a> for more information.</p>
  </div>
</div><div class="toggleable schema-attribute optional">
  <input id="toggle-schema.vault_config.auth_max_ttl" type="checkbox" class="toggle" />
  <label for="toggle-schema.vault_config.auth_max_ttl" class="toggle-title">
    <a id="schema.vault_config.auth_max_ttl"></a>

    <code><a class="attribute-name" href="#schema.vault_config.auth_max_ttl">auth_max_ttl</a>: <span class="attribute-type"><a href="config-basics.html#schema.duration"><strong>duration</strong></a></span></code>
  </label>

  <div class="toggle-content attribute-content">
    <p>Maximum duration to elapse before forcing the client to log in again.</p>
  </div>
</div><div class="toggleable schema-attribute optional">
  <input id="toggle-schema.vault_config.auth_retry_max" type="checkbox" class="toggle" />
  <label for="toggle-schema.vault_config.auth_retry_max" class="toggle-title">
    <a id="schema.vault_config.auth_retry_max"></a>

    <code><a class="attribute-name" href="#schema.vault_config.auth_retry_max">auth_retry_max</a>: <span class="attribute-type"><a href="config-basics.html#schema.duration"><strong>duration</strong></a></span></code>
  </label>

  <div class="toggle-content attribute-content">
    <p>When failing to authenticate, give up after this amount of time.</p>
  </div>
</div><div class="toggleable schema-attribute optional">
  <input id="toggle-schema.vault_config.auth_retry_initial" type="checkbox" class="toggle" />
  <label for="toggle-schema.vault_config.auth_retry_initial" class="toggle-title">
    <a id="schema.vault_config.auth_retry_initial"></a>

    <code><a class="attribute-name" href="#schema.vault_config.auth_retry_initial">auth_retry_initial</a>: <span class="attribute-type"><a href="config-basics.html#schema.duration"><strong>duration</strong></a></span></code>
  </label>

  <div class="toggle-content attribute-content">
    <p>When retrying during authentication, start with this retry interval. The interval will increase exponentially until <code>auth_retry_max</code> is reached.</p>
  </div>
</div>
</div>
  </div>
</div>
</div>
  </div>
  
  <div class="one-of-option">
    <div class="schema-group">
  <a id="dummy-var-source"></a>
  <div class="toggleable schema-attribute required">
  <input id="toggle-schema.var_source.dummy-var-source.type" type="checkbox" class="toggle" />
  <label for="toggle-schema.var_source.dummy-var-source.type" class="toggle-title">
    <a id="schema.var_source.dummy-var-source.type"></a>

    <code><a class="attribute-name" href="#schema.var_source.dummy-var-source.type">type</a>: <span class="attribute-type"><span class="schema-scalar">dummy</span></span></code>
  </label>

  <div class="toggle-content attribute-content">
    <p>The <code>dummy</code> type supports configuring a static map of vars to values.</p><p>This is really only useful if you have no better alternative for credential management but still have sensitive values that you would like to <a href="creds-redacting.html">redact</a> them from build output.</p>
  </div>
</div><div class="toggleable schema-attribute required">
  <input id="toggle-schema.var_source.dummy-var-source.config" type="checkbox" class="toggle" />
  <label for="toggle-schema.var_source.dummy-var-source.config" class="toggle-title">
    <a id="schema.var_source.dummy-var-source.config"></a>

    <code><a class="attribute-name" href="#schema.var_source.dummy-var-source.config">config</a>: <span class="attribute-type"><a href="vars.html#schema.dummy_config"><strong>dummy_config</strong></a></span></code>
  </label>

  <div class="toggle-content attribute-content">
    <div class="schema">
  <h2 class="schema-header"><a class="anchor-target" name="schema.dummy_config" href="#schema.dummy_config"></a><code>dummy_config</code> schema</h2>

  <div class="toggleable schema-attribute required">
  <input id="toggle-schema.dummy_config.vars" type="checkbox" class="toggle" />
  <label for="toggle-schema.dummy_config.vars" class="toggle-title">
    <a id="schema.dummy_config.vars"></a>

    <code><a class="attribute-name" href="#schema.dummy_config.vars">vars</a>: <span class="attribute-type"><a href="config-basics.html#schema.vars"><strong>vars</strong></a></span></code>
  </label>

  <div class="toggle-content attribute-content">
    <p>A mapping of var name to var value.</p>
  </div>
</div>
</div>
  </div>
</div>
</div>
  </div>
  
</div>
</div>

  
    
  
</div>
    
      <div class="section" id="section_cluster-wide-credential-manager">
  
  <h3 class="section-header"><a class="anchor-target" name="cluster-wide-credential-manager" href="#cluster-wide-credential-manager"></a>The cluster-wide credential manager</h3>
  

  <p>Concourse can be configured with a single cluster-wide credential manager, which acts as a source for any vars which do not specify a source name.</p><p>See <a href="creds.html">Credential Management</a> for more information.</p><blockquote class="aside"><p>In the future we would like to introduce support for multiple cluster-wide var sources, configured using the <a href="vars.html#schema.var_source"><strong><code>var_source</code></strong> schema</a> schema, and begin deprecating the <a href="vars.html#cluster-wide-credential-manager">cluster-wide credential manager</a>.</p></blockquote>

  
    
  
</div>
    
  
</div>
    
  
</div>

          <nav class="prev-next">
          
            <div class="prev">
              prev:

              
              <span class="section-number">1.5</span>
              

              <a href="pipelines.html">Pipelines</a>
            </div>
          

          
            <div class="next">
              next:

              
              <span class="section-number">1.7</span>
              

              <a href="resources.html">Resources</a>
            </div>
          
          </nav>
        </div>

        <div class="page-aside">
          <div class="page-partial">
            <div class="content">
  <h2>Examples</h2>

  <div class="example">
  <h3>Dummy Vars</h3>

  <p>Here&#39;s a copy-pasteable example using the <a href="vars.html#dummy-var-source"><code>dummy</code> var source</a>, just to demonstrate named <code>((var))</code> syntax:</p><pre><code class="language-yaml">var_sources:
- name: dumb
  type: dummy
  config:
    vars:
      simple: hello!
      user:
        username: big
        password: sekrit

jobs:
- name: print-creds
  plan:
  - task: print
    config:
      platform: linux

      image_resource:
        type: registry-image
        source: {repository: ubuntu}

      run:
        path: bash
        args:
        - -c
        - |
          echo simple: ((dumb:simple))
          echo username: ((dumb:user.username))
          echo password: ((dumb:user.password))</code></pre><p>The <code>print-creds</code> job above will print the following:</p><pre>simple: hello!
username: big
password: sekrit</pre><p>With <a href="creds-redacting.html">credential redaction</a> enabled, the output above will actually print the following:</p><pre>simple: ((redacted))
username: ((redacted))
password: ((redacted))</pre><p>The <code>dummy</code> var source type is, well, pretty dumb. It just provides whatever vars you tell it to. It primarily exists for testing purposes, and is useful as a stand-in in place of a real credential manager where you can at least have the credentials redacted from build output.</p><p>In production, you&#39;ll probably want to use something like <a href="vars.html#vault-var-source"><code>vault</code></a> instead.</p>
</div>
</div>
          </div>
          </div>
      </div>
    </div>

    <ul class="improve-docs">
      <li><img src="images/icons/github-box.svg" /> <a href="https://github.com/concourse/docs">help improve this site</a></li>
      <li><img src="images/booklit.svg" /> powered by <a href="https://vito.github.io/booklit">Booklit</a></li>
    </ul>
  </body>
</html>